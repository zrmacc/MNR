<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Zachary McCaw" />

<meta name="date" content="2018-07-19" />

<title>Hypothesis Testing in Multivariate Normal Regression</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Hypothesis Testing in Multivariate Normal Regression</h1>
<h4 class="author"><em>Zachary McCaw</em></h4>
<h4 class="date"><em>2018-07-19</em></h4>



<div id="contents" class="section level1">
<h1>Contents</h1>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#example-data">Example Data</a></li>
<li><a href="#bivariate-outcome-score-test">Bivariate Outcome Score Test</a></li>
<li><a href="#multivariate-outcome-score-test">Multivariate Outcome Score Test</a></li>
</ul>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Suppose that multiple continuous outcomes are observed for each subject. One outcome is designated as being of primary interest. Call this the <em>target</em> outcome. The remaining <em>surrogate</em> outcomes are of secondary interest, but are thought to covary with the target outcome. This package leverages the covariation between the target and surrogate outcomes in order to improve inference on the target outcome. Specifically, the vector of target and surrogate outcomes is taken to follow a multivariate normal distribution. Regression models are specified for the target and surrogate outcomes. Each outcome is allowed its own regression model. The covariance matrix of the target and surrogate outcomes is left unstructured. Score tests are provided for testing whether an arbitrary (sub)set of the target outcome regression parameters are equal to some reference value.</p>
</div>
<div id="model" class="section level2">
<h2>Model</h2>
<p>Let <span class="math inline">\(y_{i}\in\mathbb{R}^{k}\)</span> denote a continuous response vector observed for each of <span class="math inline">\(n\)</span> subjects. Partition the response vector as <span class="math inline">\(y_{i} = (t_{i},s_{i})\)</span>. The first component <span class="math inline">\(t_{i}\in\mathbb{R}^{1}\)</span> is the <em>target</em> outcome, while the second component <span class="math inline">\(s_{i}\in\mathbb{R}^{k-1}\)</span> contains the <em>surrogate</em> outcomes. For example, <span class="math inline">\(t_{i}\)</span> might represent the gold-standard measurement, and <span class="math inline">\(s_{i}\)</span> a collection of one or more surrogate measurements. Conditional on covariates, the overall response vector <span class="math inline">\(y_{i}\in\mathbb{R}^{k}\)</span> is taken as multivariate normal, with an unstructured covariance matrix:</p>
<p><span class="math display">\[
y_{i}|Z_{i} \sim N \binom{\mu_{T,i}}{\mu_{S,i}}, \left(
\begin{array}{c c}
\Sigma_{TT} &amp; \Sigma_{TS} \\
\Sigma_{ST} &amp; \Sigma_{SS}
\end{array}
\right)
\]</span></p>
<p>Regression models are specified for the target <span class="math inline">\(\mu_{T,i} = x_{i}'\beta\)</span> and surrogate <span class="math inline">\(\mu_{S,i} = \Xi_{i}\alpha\)</span> means. Here <span class="math inline">\(x_{i}\)</span> is a <span class="math inline">\(p\times 1\)</span> vector of covariates for the target mean, and <span class="math inline">\(\Xi_{i}\)</span> is a <span class="math inline">\((k-1)\times q\)</span> matrix of covariates for the surrogate mean. <span class="math inline">\(\beta\)</span> is the target regression parameter, while <span class="math inline">\(\alpha\)</span> is the surrogate regression parameter. Collect <span class="math inline">\(x_{i}\)</span> and <span class="math inline">\(\Xi_{i}\)</span> into the subject-specific design matrix <span class="math inline">\(Z_{i}\)</span>. The overall regression model is: <span class="math display">\[
\mu_{i} \equiv \binom{\mu_{T,i}}{\mu_{S,i}} = \left(
\begin{array}{c c}
x_{i}' &amp; 0 \\
0 &amp; \Xi_{i}
\end{array}
\right)
\binom{\beta}{\alpha} \equiv Z_{i}\gamma
\]</span></p>
<p>Finally, partition the target regression parameter as <span class="math inline">\(\beta = (\beta_{1},\beta_{2})\)</span>. This package provides score tests for assessing <span class="math inline">\(H_{0}:\beta_{1}=\beta_{10}\)</span>.</p>
</div>
</div>
<div id="example-data" class="section level1">
<h1>Example Data</h1>
<div id="bivariate-outcome-data" class="section level2">
<h2>Bivariate Outcome Data</h2>
<p>The list <code>D.bnr</code> contains simulated data for <span class="math inline">\(n=1000\)</span> subjects with bivariate normal outcomes. The target <code>yt</code> and surrogate <code>ys</code> outcomes each have unit variance, and the target-surrogate correlation is <span class="math inline">\(\rho=0.5\)</span>. The target and surrogate means each depend on an intercept and three independent, standard normal covariates. The model matrix for the target outcome is <code>Zt</code>, and the model matrix for the surrogate outcome is <code>Zs</code>. <code>Beta</code> contains the true regression coefficients for the target mean, and <code>Alpha</code> contains the true regression coefficients for the surrogate mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MNR);
<span class="co"># Extract components</span>
yt =<span class="st"> </span>D.bnr$yt;
ys =<span class="st"> </span>D.bnr$ys;
Zt =<span class="st"> </span>D.bnr$Zt;
Zs =<span class="st"> </span>D.bnr$Zs;
<span class="kw">cat</span>(<span class="st">&quot;Target outcome:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">head</span>(yt);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Surrogate outcome:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">head</span>(ys);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Target model matrix:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">head</span>(Zt);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Surrogate model matrix:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">head</span>(Zs);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Target regression parameters:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">show</span>(D.bnr$Beta);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Surrogate regression parameters:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">show</span>(D.bnr$Alpha);</code></pre></div>
<pre><code>## Target outcome: 
##          1          2          3          4          5          6 
## -2.1775941 -0.6433499 -1.2380953 -1.1208658  0.6387681 -0.9404964 
## 
## Surrogate outcome: 
##           1           2           3           4           5           6 
## -0.00438639  1.15376520  1.25420024  0.14000159  0.28943876  0.88898029 
## 
## Target model matrix: 
##   int.t          x1         x2          x3
## 1     1  0.21475678  0.4998932 -0.08250593
## 2     1  1.59638109 -0.8656795  1.66117669
## 3     1  0.09539529  0.4924589 -1.97274622
## 4     1 -1.25801656 -1.3526159 -2.14845755
## 5     1  0.06733360 -0.3943881 -1.14182522
## 6     1 -0.78741717  0.7711460  2.98557356
## 
## Surrogate model matrix: 
##   int.s         xi1         xi2         xi3
## 1     1 -0.60635079 -0.01501802  0.21116190
## 2     1 -1.25536475  0.48508411  0.63642953
## 3     1  1.08003701 -0.37448487  0.09266153
## 4     1  0.08325608 -1.18135648  0.01246761
## 5     1 -0.09917261  1.19255878 -0.90633463
## 6     1  2.49662596  0.57356246 -1.08234428
## 
## Target regression parameters: 
##   b0   b1   b2   b3 
## -1.0  0.1  0.1  0.0 
## 
## Surrogate regression parameters: 
##   a0   a1   a2   a3 
##  1.0 -0.1 -0.1 -0.1</code></pre>
</div>
<div id="trivariate-outcome-data" class="section level2">
<h2>Trivariate Outcome Data</h2>
<p>The list <code>D.mnr</code> contains a simulated data set for <span class="math inline">\(n=1000\)</span> subjects with trivariate normal outcomes. The target <code>yt</code> and surrogate <code>Ys</code> outcomes each have unit variances. The target-surrogate correlation structure is exchangeable; each pair of outcomes has correlation <span class="math inline">\(\rho=0.5\)</span>. The target and first surrogate means each depend on an intercept and three independent, standard normal covariates. The second surrogate mean depends on an intercept and four such covariates. The model matrix for the target outcome is <code>Zt</code>. The list <code>Ls</code> contains two model matrices, one for each surrogate outcome. The first, <code>Xi1</code> is an <span class="math inline">\(1000\times 4\)</span> model matrix for the first surrogate outcome. The second, <code>Xi2</code> is an <span class="math inline">\(1000\times 5\)</span> model matrix for the second surrogate outcome. The overall surrogate model matrix <code>Zs</code> is generated within the testing function. By default, each surrogate outcome is permitted its own regression parameters. To fit a <em>parallel coefficient model</em>, in which the surrogates share a common set of regression coefficients, specify <code>parallel=T</code> during hypothesis testing. Fitting a parallel coefficient model requires that each design matrix has the same number of columns. <code>Beta</code> contains the true regression coefficients for the target mean, and <code>Alpha</code> contains the true regression coefficients for the surrogate mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MNR);
<span class="co"># Extract components</span>
yt =<span class="st"> </span>D.mnr$yt;
Ys =<span class="st"> </span>D.mnr$Ys;
Zt =<span class="st"> </span>D.mnr$Zt;
Ls =<span class="st"> </span>D.mnr$Ls;
<span class="kw">cat</span>(<span class="st">&quot;Target outcome:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">head</span>(yt);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Surrogate outcomes:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">head</span>(Ys);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Target model matrix:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">head</span>(Zt);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Surrogate model matrices:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">head</span>(Ls$Xi1);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">head</span>(Ls$Xi2);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Target regression parameters:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">show</span>(D.mnr$Beta);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Surrogate regression parameters&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">show</span>(D.mnr$Alpha);</code></pre></div>
<pre><code>## Target outcome: 
##          1          2          3          4          5          6 
## -1.1355092 -1.1555698 -3.1820548 -2.3106878 -0.5271279 -1.5898073 
## 
## Surrogate outcomes: 
##        y.s1      y.s2
## 1 1.0859936 1.8317890
## 2 1.1687834 2.1326281
## 3 0.3840986 1.0835291
## 4 0.5095097 0.1996144
## 5 1.0211076 2.2989638
## 6 1.9449832 2.0919847
## 
## Target model matrix: 
##   int.t         x1           x2          x3
## 1     1 -0.9157211 -0.967320838 -1.06790563
## 2     1 -1.6354771 -0.008087443  0.09711701
## 3     1 -0.2941834 -0.147777850 -0.87567080
## 4     1 -0.1428488  1.778802601  0.63141124
## 5     1  1.1652948  0.468497648  0.71073700
## 6     1  0.6457990 -0.227475132  2.03778239
## 
## Surrogate model matrices: 
##      int.s1       xi11       xi12          xi13
## [1,]      1 -1.4395537 -0.3740681  1.5130474139
## [2,]      1  0.1674263 -0.2899386  2.6596479915
## [3,]      1  0.8630031 -0.5530195  0.9662611896
## [4,]      1  1.5602511  0.3050545  0.1524413326
## [5,]      1  0.7642962 -1.1030871  0.2749556706
## [6,]      1  1.1860374  0.3805394 -0.0007527277
## 
##      int.s2        xi21       xi22        xi23       xi24
## [1,]      1  1.34363436 -1.1195984 -0.00130081 -0.6959728
## [2,]      1 -0.42858546 -1.0723851 -0.44431810  0.4985890
## [3,]      1 -0.87064367 -2.0306128 -0.08852820 -0.2751421
## [4,]      1 -0.07328819 -1.7535199 -1.11290174 -0.8265508
## [5,]      1 -2.00706806 -0.8361248 -0.03223253  0.2806040
## [6,]      1  0.71148498  1.1797593 -2.23657957 -0.4730092
## 
## Target regression parameters: 
##   b0   b1   b2   b3 
## -1.0  0.1  0.1  0.0 
## 
## Surrogate regression parameters 
##  a10  a11  a12  a13  a20  a21  a22  a23  a24 
##  1.0 -0.1 -0.1 -0.1  2.0  0.1  0.1  0.1  0.1</code></pre>
</div>
<div id="formatting-assumptions" class="section level2">
<h2>Formatting Assumptions</h2>
<p>The target outcome <code>yt</code> is a numeric vector of length <span class="math inline">\(n\)</span>. In the case of a single surrogate, <code>ys</code> is a numeric vector of length <span class="math inline">\(n\)</span>. In the case of multiple surrogates, <code>Ys</code> is an <span class="math inline">\(n\times(k-1)\)</span> numeric matrix. The target model <code>Zt</code> is an <span class="math inline">\(n\times p\)</span> numeric matrix. In the case of a single surrogate, <code>Zs</code> is an <span class="math inline">\(n\times q\)</span> numeric matrix. In the case of multiple surrogates, <span class="math inline">\(Ls\)</span> is a list of numeric matrices, each with <span class="math inline">\(n\)</span> rows. In the case of a parallel coefficient model, each matrix in <span class="math inline">\(Ls\)</span> must additionally have the same number of columns. All factors and interactions must have been expanded in advance. None of the inputs should contain missing values.</p>
</div>
</div>
<div id="bivariate-outcome-score-test" class="section level1">
<h1>Bivariate Outcome Score Test</h1>
<p>The case of a single surrogate was implemented separately from the general case because it is possible to expedite the fitting procedure. The following demonstrates various score tests possible using the example data. The first is an overall test of <span class="math inline">\(H_{0}:\beta_{1}=\beta_{2}=\beta_{3}=0\)</span>, which is false. The second assesses <span class="math inline">\(H_{0}:\beta_{1}=\beta_{2}=0\)</span>, which is again false, treating <span class="math inline">\(\beta_{3}\)</span> as a nuisance. The third considers <span class="math inline">\(H_{0}:\beta_{1}=0.1\)</span>, which is in fact true, treating <span class="math inline">\(\beta_{2}\)</span> and <span class="math inline">\(\beta_{3}\)</span> as nuisances. The final considers <span class="math inline">\(H_{0}:\beta_{3}=0\)</span>, which is again true, treating <span class="math inline">\(\beta_{1}\)</span> and <span class="math inline">\(\beta_{2}\)</span> as nuisances. All models include an intercept.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract components</span>
yt =<span class="st"> </span>D.bnr$yt;
ys =<span class="st"> </span>D.bnr$ys;
Zt =<span class="st"> </span>D.bnr$Zt;
Zs =<span class="st"> </span>D.bnr$Zs;
<span class="kw">cat</span>(<span class="st">&quot;True regression coefficients:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">show</span>(D.bnr$Beta);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Joint score test of b1 = b2 = b3 = 0&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">signif</span>(<span class="kw">Score.bnr</span>(yt,ys,Zt,Zs,<span class="dt">L=</span><span class="kw">c</span>(F,T,T,T)),<span class="dt">digits=</span><span class="dv">2</span>);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;Joint score test of b1 = b2 = 0, treating b3 as a nuisance&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">signif</span>(<span class="kw">Score.bnr</span>(yt,ys,Zt,Zs,<span class="dt">L=</span><span class="kw">c</span>(F,T,T,F)),<span class="dt">digits=</span><span class="dv">2</span>);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;Individual score test of b1 = 0.1, treating b2 and b3 as nuisances&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">signif</span>(<span class="kw">Score.bnr</span>(yt,ys,Zt,Zs,<span class="dt">L=</span><span class="kw">c</span>(F,T,F,F),<span class="dt">b10=</span><span class="kw">c</span>(<span class="fl">0.1</span>)),<span class="dt">digits=</span><span class="dv">2</span>);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;Individual score test of b3 = 0, treating b1 and b2 as nuisances&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">signif</span>(<span class="kw">Score.bnr</span>(yt,ys,Zt,Zs,<span class="dt">L=</span><span class="kw">c</span>(F,F,F,T)),<span class="dt">digits=</span><span class="dv">2</span>);</code></pre></div>
<pre><code>## True regression coefficients: 
##   b0   b1   b2   b3 
## -1.0  0.1  0.1  0.0 
## 
## Joint score test of b1 = b2 = b3 = 0 
##   Score      df       p 
## 1.7e+01 3.0e+00 5.9e-04 
## 
##  Joint score test of b1 = b2 = 0, treating b3 as a nuisance 
##   Score      df       p 
## 1.7e+01 2.0e+00 1.8e-04 
## 
##  Individual score test of b1 = 0.1, treating b2 and b3 as nuisances 
## Score    df     p 
##   1.6   1.0   0.2 
## 
##  Individual score test of b3 = 0, treating b1 and b2 as nuisances 
## Score    df     p 
##  0.19  1.00  0.67</code></pre>
</div>
<div id="multivariate-outcome-score-test" class="section level1">
<h1>Multivariate Outcome Score Test</h1>
<p>Hypothesis testing for two or more surrogate outcomes is analogous to the bivariate case. The same hypothesis tests discussed above are repeated for the trivariate outcome model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract components</span>
yt =<span class="st"> </span>D.mnr$yt;
Ys =<span class="st"> </span>D.mnr$Ys;
Zt =<span class="st"> </span>D.mnr$Zt;
Ls =<span class="st"> </span>D.mnr$Ls;
<span class="kw">cat</span>(<span class="st">&quot;True regression coefficients:&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">show</span>(D.mnr$Beta);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">cat</span>(<span class="st">&quot;Joint score test of b1 = b2 = b3 = 0&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">signif</span>(<span class="kw">Score.mnr</span>(yt,Ys,Zt,Ls,<span class="dt">L=</span><span class="kw">c</span>(F,T,T,T)),<span class="dt">digits=</span><span class="dv">2</span>);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;Joint score test of b1 = b2 = 0, treating b3 as a nuisance&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">signif</span>(<span class="kw">Score.mnr</span>(yt,Ys,Zt,Ls,<span class="dt">L=</span><span class="kw">c</span>(F,T,T,F)),<span class="dt">digits=</span><span class="dv">2</span>);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;Individual score test of b1 = 0.1, treating b2 and b3 as nuisances&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">signif</span>(<span class="kw">Score.mnr</span>(yt,Ys,Zt,Ls,<span class="dt">L=</span><span class="kw">c</span>(F,T,F,F),<span class="dt">b10=</span><span class="kw">c</span>(<span class="fl">0.1</span>)),<span class="dt">digits=</span><span class="dv">2</span>);
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;Individual score test of b3 = 0, treating b1 and b2 as nuisances&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
<span class="kw">signif</span>(<span class="kw">Score.mnr</span>(yt,Ys,Zt,Ls,<span class="dt">L=</span><span class="kw">c</span>(F,F,F,T)),<span class="dt">digits=</span><span class="dv">2</span>);</code></pre></div>
<pre><code>## True regression coefficients: 
##   b0   b1   b2   b3 
## -1.0  0.1  0.1  0.0 
## 
## Joint score test of b1 = b2 = b3 = 0 
##   Score      df       p 
## 5.1e+01 3.0e+00 5.4e-11 
## 
##  Joint score test of b1 = b2 = 0, treating b3 as a nuisance 
##   Score      df       p 
## 5.1e+01 2.0e+00 1.0e-11 
## 
##  Individual score test of b1 = 0.1, treating b2 and b3 as nuisances 
##   Score      df       p 
## 2.2e+01 1.0e+00 2.4e-06 
## 
##  Individual score test of b3 = 0, treating b1 and b2 as nuisances 
## Score    df     p 
##  0.38  1.00  0.54</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
